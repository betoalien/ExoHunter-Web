<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1" />
  <title>ExoHunter · Results</title>

  <!-- Project CSS -->
  <link rel="stylesheet" href="/static/css/styles.css" />

<!-- CSS de DataTables v2 (vanilla) -->
<link rel="stylesheet" href="https://cdn.datatables.net/2.3.4/css/dataTables.dataTables.css" />

  <meta name="description" content="ExoHunter — View processed results, filter by category, and download CSV/JSON reports." />
  <meta name="color-scheme" content="light dark" />
</head>
<body data-page="results">
  <header class="site-header" role="banner">
    <nav class="nav container" aria-label="Primary">
      <div class="brand">
        <a class="brand-link" href="/">ExoHunter</a>
      </div>
      <ul class="nav-list">
        <li><a href="/">Home</a></li>
        <li><a aria-current="page" href="/results">Results</a></li>
        <li><a href="/healthz" target="_blank" rel="noopener">Health</a></li>
      </ul>
    </nav>
  </header>

  <!-- Slim hero for consistency -->
  <section class="hero hero--slim" role="region" aria-label="Header banner">
    <div class="hero-overlay"></div>
    <div class="hero-content container">
      <h1 class="hero-title">Results</h1>
      <p class="hero-subtitle">Review processed objects, filter by category, and download reports.</p>
    </div>
  </section>

  <main id="main" class="container" role="main">
    <!-- Actions / Downloads -->
    <section class="card section">
      <header class="section-header">
        <h2>Report Outputs</h2>
        <p class="section-subtitle">Download the latest processed report or refresh to fetch new results.</p>
      </header>

      <div class="results-actions" style="display:flex; gap:0.75rem; flex-wrap:wrap;">
        <a id="linkDownloadCSV" class="btn btn-primary" href="#" download aria-disabled="true">Download CSV</a>
        <a id="linkDownloadJSON" class="btn btn-ghost" href="#" download aria-disabled="true">Download JSON</a>
        <button id="btnRefreshResults" type="button" class="btn btn-ghost">Refresh</button>
      </div>

      <div id="resultsStatus" class="status status--info" role="status" aria-live="polite" style="margin-top:1rem;">
        Waiting for results…
      </div>

      <output id="resultsSummary" class="output" style="display:block; margin-top:0.75rem;"></output>
    </section>

    <!-- Filters (client-side quick filters; DataTables also has its own search box) -->
    <section class="card section">
      <header class="section-header">
        <h2>Filters</h2>
        <p class="section-subtitle">Quickly narrow down by ID or category. (Client-side filter for now.)</p>
      </header>

      <form id="filterForm" class="form-grid" novalidate>
        <div class="form-row">
          <label for="searchId" class="form-label">Search by Object ID</label>
          <input id="searchId" name="searchId" type="text" placeholder="e.g., KOI-1234" />
        </div>

        <div class="form-row">
          <label for="categorySelect" class="form-label">Category</label>
          <select id="categorySelect" name="category">
            <option value="">All</option>
            <option value="confirmed_planet">Confirmed Planet</option>
            <option value="candidate">Candidate</option>
            <option value="likely_false_positive">Likely False Positive</option>
            <option value="rocky_candidate">Rocky Candidate</option>
            <option value="super_earth_or_mini_neptune">Super-Earth / Mini-Neptune</option>
            <option value="hot_jupiter_candidate">Hot Jupiter Candidate</option>
            <option value="habitable_zone_candidate">Habitable Zone Candidate</option>
            <option value="anomalous_signal">Anomalous Signal</option>
            <option value="no_result">No Result / Invalid Data</option>
          </select>
        </div>

        <div class="form-actions">
          <button id="btnApplyFilters" type="submit" class="btn btn-primary">Apply</button>
          <button id="btnClearFilters" type="button" class="btn btn-ghost">Clear</button>
        </div>
      </form>
    </section>

          <!-- COLOR SEMAPHORE LEGEND -->
      <div class="legend" aria-label="Disposition comparison legend" style="margin-bottom:1rem; padding: 0.75rem 1rem; border: 1px solid #ccc; border-radius: 0.5rem;">
      <strong>Disposition Comparison:</strong>
      <div style="display:flex; gap: 1rem; margin-top: 0.5rem; flex-wrap: wrap;">
      <span class="tag tag--green">
       <span style="color: #1a7f37; font-weight: bold;">Green:</span> Category **missing** from original disposition (our analysis provides a new value).
       </span><br/>
      <span class="tag tag--black">
        <span style="color: inherit; font-weight: bold;">Black:</span> Category **matches** original disposition.
          </span><br/>
      <span class="tag tag--red">
       <span style="color: #b42318; font-weight: bold;">Red:</span> **Mismatch** between our category and original disposition (indicates a discrepancy).
         </span>
      </div>
      </div>
      <!-- END OF COLOR LEGEND -->
    <!-- Results table -->
    <section class="card section">
      <header class="section-header">
        <h2>Objects</h2>
        <p class="section-subtitle">
          Paginated and searchable with DataTables. We also surface original disposition next to our category.
        </p>
      </header>

      <div class="table-wrap" style="overflow:auto;">
        <!--
          DataTables note:
          - We'll initialize DT in /static/js/app.js after rows are fetched.
          - We'll add row/cell classes based on `color_hint` (green/black/red) or `disposition_compare`.
          - Columns are intentionally narrow; you can toggle visibility in app.js if needed.
        -->
        <table
          id="resultsTable"
          class="table display stripe hover"
          aria-describedby="resultsSummary"
          data-dt-enable="true"
          data-dt-page-length="25">
          <thead>
            <tr>
              <th>Object ID</th>
              <th>Original Disposition</th>
              <th>Category (ExoHunter)</th>
              <th>Score</th>
              <th>Flags</th>
              <th>Period (days)</th>
              <th>Radius (R⊕)</th>
              <th>Teq (K)</th>
              <th>Insol (F/F⊕)</th>
            </tr>
          </thead>
          <tbody>
            <!-- Filled dynamically by /static/js/app.js -->
          </tbody>
        </table>
      </div>

      <!-- Legend for coloring -->
      <div class="legend" aria-label="Disposition comparison legend" style="margin-top:0.75rem;">
        <strong>Legend:</strong>
        <span class="tag tag--green">Green = missing disposition (we provide)</span>
        <span class="tag tag--black">Black = matches disposition</span>
        <span class="tag tag--red">Red = mismatch vs disposition</span>
      </div>
    </section>
  </main>

  <footer class="site-footer" role="contentinfo">
    <div class="container footer-grid">
      <div>
        <strong>ExoHunter</strong><br />
        <small>© 2025. Anomaly-first exoplanet analytics.</small>
      </div>
      <div class="footer-links">
        <a href="https://exoplanetarchive.ipac.caltech.edu/" target="_blank" rel="noopener">NASA Exoplanet Archive</a>
        <a href="https://www.nasa.gov/" target="_blank" rel="noopener">NASA</a>
      </div>
    </div>
  </footer>

   <script src="https://code.jquery.com/jquery-3.7.1.min.js" 
    integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" 
    crossorigin="anonymous" defer></script>

<!-- DataTables JS (oficial, sin .min) -->
<script src="https://cdn.datatables.net/2.3.4/js/dataTables.js" defer></script>


  <!-- Project JS -->
  <script src="/static/js/app.js" defer></script>

</body>
</html>
